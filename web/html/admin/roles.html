{{ define "roles_content" }}

<div class="d-flex justify-content-between align-items-center">
    <h1 class="h2 mb-3">{{ .Title }}</h1>
</div>

<div class="card shadow-sm">
    <div class="card-body p-0">
        <div class="table-responsive" style="min-width: 1200px;">

            <!-- Добавляем контейнер для скролла -->
            <div style="height: calc(100vh - 400px); overflow-y: auto;">
                <table class="table table-hover mb-0" style="min-width: 1200px;" id="rolesTable">

                    {{ if .Roles }}
                    <thead>
                    <tr>
                        <th class="text-nowrap">ИД</th>
                        <th class="text-nowrap">Наименование</th>
                        <th class="text-nowrap">Описание</th>
                        <th class="text-nowrap">Дата создания</th>
                        <th class="text-nowrap">ТН владельца</th>
                        <th class="text-nowrap">Дата изменения</th>
                        <th class="text-nowrap">ТН владельца</th>
                        <th class="text-nowrap">Операции</th>
                    </tr>
                    </thead>
                    <tbody>

                    {{ range .Roles }}
                    <tr id="role-{{ .Id }}" data-id="{{ .Id }}">
                        <!-- ИД (всегда в режиме просмотра) -->
                        <td class="fw-semibold">{{ .Id }}</td>

                        <!-- Наименование - режим просмотра -->
                        <td class="view-mode forms-name">{{ .Name }}</td>

                        <!-- Описание - режим просмотра -->
                        <td class="view-mode forms-desc">{{ .Desc }}</td>

                        <!-- Наименование - режим редактирования (скрыт) -->
                        <td class="edit-mode" style="display: none;">
                            <input type="text"
                                   name="name"
                                   value="{{ .Name }}"
                                   class="form-control form-control-sm"
                                   data-original="{{ .Name }}"
                                   required>
                        </td>

                        <!-- Описание - режим редактирования (скрыт) -->
                        <td class="edit-mode" style="display: none;">
                            <input type="text"
                                   name="description"
                                   value="{{ .Desc }}"
                                   class="form-control form-control-sm"
                                   data-original="{{ .Desc }}"
                                   required>
                        </td>

                        <!-- Дата создания (всегда в режиме просмотра) -->
                        <td>{{ formatDateTime .AuditRec.CreatedAt }}</td>

                        <!-- ТН создателя (всегда в режиме просмотра) -->
                        <td>{{ .AuditRec.CreatedBy }}</td>

                        <!-- Дата изменения -->
                        <td class="update-at">{{ formatDateTime .AuditRec.UpdatedAt }}</td>

                        <!-- ТН редактора -->
                        <td class="update-by">{{ .AuditRec.UpdatedBy }}</td>

                        <!-- Кнопки операций -->
                        <td>
                            <div class="d-flex justify-content-center gap-2">
                                <!-- Кнопка редактирования (отображается в view-mode) -->
                                <button class="btn btn-sm btn-outline-primary edit-btn"
                                        title="Редактировать">
                                    <span>✏️</span>
                                </button>

                                <!-- Кнопки сохранения/отмены (скрыты в view-mode) -->
                                <div class="edit-buttons" style="display: none;">
                                    <button class="btn btn-sm btn-success save-role-btn" title="Сохранить">
                                        <span>✓</span>
                                    </button>
                                    <button class="btn btn-sm btn-secondary cancel-btn" title="Отмена">
                                        <span>✗</span>
                                    </button>
                                </div>
                            </div>
                        </td>
                    </tr>
                    {{ end }}
                    </tbody>
                </table>
            </div>
        </div>

        <p style="margin-top: 20px; color: #666;">
            Всего ролей: {{ len .Roles }}
        </p>
        {{ else }}
        <p style="text-align: center; color: #666; font-style: italic;">
            Нет данных о ролях
        </p>
        {{ end }}

    </div>
</div>

{{ end }}